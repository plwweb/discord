name: Discord Online 24/7 (No-Downtime)
on:
  schedule:
    # สั่งให้บอทตัวใหม่มาปลุกทุกๆ 2 ชั่วโมง
    - cron: '0 */2 * * *' 
  workflow_dispatch:

jobs:
  run-discord:
    runs-on: ubuntu-latest
    # สำคัญมาก: ห้าม Cancel งานที่กำลังรันอยู่ เพื่อให้เกิดการรันซ้อนกันได้
    concurrency:
      group: discord-online
      cancel-in-progress: false 
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: 18
      - run: npm install discord.js-selfbot-v13
      # รันยาว 130 นาที (รันนานกว่ารอบของ Cron 10 นาที เพื่อให้เกิดการซ้อนทับ)
      - run: timeout 130m node index.js || true
        env:
          DISCORD_TOKEN: ${{ secrets.DISCORD_TOKEN }}
